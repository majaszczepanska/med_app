<div class="container">
  <h1>Medical Management System</h1>

  <div class="layout">
    
    <div class="form-panel">
      <h3>@if (isEditing) {Edit Patient} @else {Add New Patient}</h3>

      <label>First Name:</label>
      <input type="text" [(ngModel)]="newPatient.firstName" placeholder="Enter first name">

      <label>Last Name:</label>
      <input type="text" [(ngModel)]="newPatient.lastName" placeholder="Enter last name">

      <label>PESEL:</label>
      <input type="text" [(ngModel)]="newPatient.pesel" placeholder="pesel">

      <label>Disease:</label>
      <input type="text" [(ngModel)]="newPatient.disease" placeholder="Disease">
      
      <label>Main doctor (ID):</label>
      <input type="number" min="1" [(ngModel)]="newPatient.mainDoctor" placeholder="Doctor ID">

      @if (isEditing) {
        <button (click)="onSubmit()" class="update-btn">
          UPDATE PATIENT
        </button>
        <button (click)="cancelEdit()" class="cancel-btn">
          CANCEL
        </button>
      } @else {
        <button (click)="onSubmit()" class="save-btn">
          SAVE PATIENT
        </button>
      }
      
    </div>

    <div class="table-panel">
      <h3>Patient Registry</h3>
      
      <table class="patient-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Full Name</th>
            <th>Pesel</th>
            <th>Disease</th>
            <th>Doctor ID</th> <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          @for (p of patients; track p.id){
            <tr>
              <td>{{ p.id }}</td>
              <td>{{ p.firstName }} {{ p.lastName }}</td>
              <td>{{ p.pesel }}</td>
              <td>{{ p.disease }}</td>
              
              <td>
                @if (p.mainDoctor) {
                  <span> {{ p.mainDoctor.id }}</span>
                }@else {
                  <span>-</span>
                }
              </td>

              <td>
                <button (click)="editPatient(p)" class="edit-btn">
                  EDIT
                </button>
                <button (click)="removePatient(p.id)" class="delete-btn">
                  DELETE
                </button>
              </td>
            </tr>
          }
          
          @if (patients.length === 0) {
            <tr>
              <td colspan="6" class="empty-state">
                No patients found in the database.
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>

  </div>
</div>